BMS_Rev1 Documentation

Analog measurements:
	Charge V Meas		Voltage measurement at charger input
	5V Input V Meas		Voltage measurement at 5V regulator
	Output V Meas		Voltage Measurement at output
	Array I Meas		Current measurement at pack high side


Physical Inputs:
	Logic Power Switch		Disconnects 5V regulator
	


Outputs:
	
	
ICs:
	ATTiny828		Used for analog measurements from array

	


Notes:

	5V power is currently supplied by a Murata OKI-78SR buck converter with a Pi filter. This should probably be changed, as the OKI is extremely inefficient at low (<200mA) current levels.

	A large, high-current diode at the charger input prevents shorting the battery.

	The logic power switch removes power to the regulator. When switched "off", the only waste power is leakage current is through the main MOSFET, which is very very low. When switched "off", the switch connects to the charger input. (Even when switched off, the 5V logic will be powered up if the charger is connected.)
	
	The 5V Input V Meas is used as pack voltage measurement when the system is switched on. When switched off, it is disconnected from the battery, and connected to the charger input. 

	When the charger is connected, the Charge and 5V Input V Measurements are compared in software. If they are equal (i.e., logic switch is set set to "off", system should be in a "Charge Only" mode. If the logic switch is set to off, the system is powered on and the charger is disconnected, the system will suddenly shut off (as power to the 5V logic would be lost).

	With the Logic switch on, the system may be simultaneously run and charged. This is not necessarily recommended, as it may (or may not) cause odd charger behavior, depending on the external charger. 

	The ATTiny 828 uses ICSP pogo pads for programming. A solder jumper connects the ATTiny to the 5V supply, so it a pogo programmer can be used without affecting everything else connected to the 5V line.

	The Balance charger connects to a 9-pin balance lead that passes through the BMS. There are currently 8 resistor dividers to check the voltage of each cell.

	The LCD will be connected as explained on this comment on spark fun. [unfinished]
	https://www.sparkfun.com/products/709#comment-50c4c1a4ce395fc170000000
	(I AM NOT SURE IF THIS IS 100% RELIABLE, BUT I HAVE NOT FOUND A BETTER IMPLEMENTATION)

	A differential voltage amplifier is currently on the board for cell voltage checking. It is not fully implemented yet. This may be shelved for a second revision. Implementing this solution will significantly increase the cost of the system.